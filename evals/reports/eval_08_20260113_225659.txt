============================================================
EVAL 08: CROSS-FITTING & RIDGE CALIBRATION
============================================================

True mu* = 0.241016

------------------------------------------------------------
PART A: CROSS-FITTING NECESSITY
------------------------------------------------------------

--- A1: No-Split vs Cross-Fit ---
no_split:   0%|                                          | 0/10 [00:00<?, ?it/s]/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
no_split:  10%|███▍                              | 1/10 [00:18<02:43, 18.19s/it]/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
no_split:  20%|██████▊                           | 2/10 [00:25<01:36, 12.04s/it]/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
no_split:  30%|██████████▏                       | 3/10 [00:35<01:14, 10.69s/it]/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
no_split:  40%|█████████████▌                    | 4/10 [00:50<01:16, 12.73s/it]/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
no_split:  50%|█████████████████                 | 5/10 [01:02<01:01, 12.35s/it]/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
no_split:  60%|████████████████████▍             | 6/10 [01:11<00:44, 11.20s/it]/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
no_split:  70%|███████████████████████▊          | 7/10 [01:19<00:30, 10.20s/it]/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
no_split:  80%|███████████████████████████▏      | 8/10 [01:29<00:20, 10.10s/it]/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
no_split:  90%|██████████████████████████████▌   | 9/10 [01:46<00:12, 12.10s/it]/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(
no_split: 100%|█████████████████████████████████| 10/10 [01:57<00:00, 11.86s/it]no_split: 100%|█████████████████████████████████| 10/10 [01:57<00:00, 11.74s/it]
crossfit_5:   0%|                                        | 0/10 [00:00<?, ?it/s]crossfit_5:  10%|███▏                            | 1/10 [00:21<03:10, 21.12s/it]crossfit_5:  20%|██████▍                         | 2/10 [00:51<03:32, 26.51s/it]crossfit_5:  30%|█████████▌                      | 3/10 [01:07<02:30, 21.53s/it]crossfit_5:  40%|████████████▊                   | 4/10 [01:24<01:59, 19.99s/it]crossfit_5:  50%|████████████████                | 5/10 [01:43<01:37, 19.56s/it]crossfit_5:  60%|███████████████████▏            | 6/10 [01:55<01:08, 17.14s/it]crossfit_5:  70%|██████████████████████▍         | 7/10 [02:02<00:41, 13.77s/it]crossfit_5:  80%|█████████████████████████▌      | 8/10 [02:12<00:25, 12.55s/it]crossfit_5:  90%|████████████████████████████▊   | 9/10 [02:19<00:10, 10.77s/it]crossfit_5: 100%|███████████████████████████████| 10/10 [02:25<00:00,  9.33s/it]crossfit_5: 100%|███████████████████████████████| 10/10 [02:25<00:00, 14.56s/it]

Config            Coverage   SE Ratio       Bias
--------------------------------------------------
no_split             90.0%      1.352    -0.1709
crossfit_5           80.0%      1.276    -0.0210

A1: FAIL
  Cross-fit coverage: 80.0%
  No-split coverage: 90.0%

--- A2: Minimum Folds Required ---
K=2:   0%|                                               | 0/10 [00:00<?, ?it/s]K=2:  10%|███▉                                   | 1/10 [00:02<00:22,  2.47s/it]K=2:  20%|███████▊                               | 2/10 [00:04<00:15,  1.98s/it]K=2:  30%|███████████▋                           | 3/10 [00:06<00:13,  1.95s/it]K=2:  40%|███████████████▌                       | 4/10 [00:07<00:10,  1.78s/it]K=2:  50%|███████████████████▌                   | 5/10 [00:09<00:08,  1.79s/it]K=2:  60%|███████████████████████▍               | 6/10 [00:11<00:07,  1.84s/it]K=2:  70%|███████████████████████████▎           | 7/10 [00:13<00:06,  2.04s/it]K=2:  80%|███████████████████████████████▏       | 8/10 [00:15<00:04,  2.06s/it]K=2:  90%|███████████████████████████████████    | 9/10 [00:18<00:02,  2.13s/it]K=2: 100%|██████████████████████████████████████| 10/10 [00:21<00:00,  2.55s/it]K=2: 100%|██████████████████████████████████████| 10/10 [00:21<00:00,  2.16s/it]
K=5:   0%|                                               | 0/10 [00:00<?, ?it/s]K=5:  10%|███▉                                   | 1/10 [00:09<01:25,  9.45s/it]K=5:  20%|███████▊                               | 2/10 [00:18<01:11,  8.98s/it]K=5:  30%|███████████▋                           | 3/10 [00:27<01:05,  9.29s/it]K=5:  40%|███████████████▌                       | 4/10 [00:34<00:50,  8.41s/it]K=5:  50%|███████████████████▌                   | 5/10 [00:41<00:38,  7.78s/it]K=5:  60%|███████████████████████▍               | 6/10 [00:50<00:32,  8.18s/it]K=5:  70%|███████████████████████████▎           | 7/10 [00:58<00:24,  8.14s/it]K=5:  80%|███████████████████████████████▏       | 8/10 [01:07<00:16,  8.31s/it]K=5:  90%|███████████████████████████████████    | 9/10 [01:15<00:08,  8.29s/it]K=5: 100%|██████████████████████████████████████| 10/10 [01:26<00:00,  9.06s/it]K=5: 100%|██████████████████████████████████████| 10/10 [01:26<00:00,  8.62s/it]
K=10:   0%|                                              | 0/10 [00:00<?, ?it/s]K=10:  10%|███▊                                  | 1/10 [00:21<03:09, 21.02s/it]K=10:  20%|███████▌                              | 2/10 [00:42<02:48, 21.08s/it]K=10:  30%|███████████▍                          | 3/10 [00:58<02:12, 18.98s/it]K=10:  40%|███████████████▏                      | 4/10 [01:14<01:47, 17.86s/it]K=10:  50%|███████████████████                   | 5/10 [01:35<01:34, 18.83s/it]K=10:  60%|██████████████████████▊               | 6/10 [01:49<01:08, 17.10s/it]K=10:  70%|██████████████████████████▌           | 7/10 [02:05<00:50, 16.92s/it]K=10:  80%|██████████████████████████████▍       | 8/10 [02:22<00:33, 16.89s/it]K=10:  90%|██████████████████████████████████▏   | 9/10 [02:39<00:16, 16.83s/it]K=10: 100%|█████████████████████████████████████| 10/10 [03:16<00:00, 23.20s/it]K=10: 100%|█████████████████████████████████████| 10/10 [03:16<00:00, 19.66s/it]
K=20:   0%|                                              | 0/10 [00:00<?, ?it/s]K=20:  10%|███▊                                  | 1/10 [00:39<05:51, 39.10s/it]K=20:  20%|███████▌                              | 2/10 [01:18<05:14, 39.31s/it]K=20:  30%|███████████▍                          | 3/10 [02:00<04:44, 40.65s/it]K=20:  40%|███████████████▏                      | 4/10 [02:32<03:42, 37.02s/it]K=20:  50%|███████████████████                   | 5/10 [03:02<02:52, 34.46s/it]K=20:  60%|██████████████████████▊               | 6/10 [03:30<02:09, 32.27s/it]K=20:  70%|██████████████████████████▌           | 7/10 [04:02<01:36, 32.21s/it]K=20:  80%|██████████████████████████████▍       | 8/10 [04:31<01:02, 31.16s/it]K=20:  90%|██████████████████████████████████▏   | 9/10 [05:00<00:30, 30.53s/it]K=20: 100%|█████████████████████████████████████| 10/10 [05:35<00:00, 31.86s/it]K=20: 100%|█████████████████████████████████████| 10/10 [05:35<00:00, 33.52s/it]

K            Coverage   SE Ratio       Bias
---------------------------------------------
2               50.0%      1.916    -0.0113
5              100.0%      0.860    -0.0150
10              80.0%      1.095    -0.0150
20              90.0%      1.048    -0.0155

A2: FAIL
  Minimum K for valid coverage: 20

------------------------------------------------------------
PART B: RIDGE CALIBRATION
------------------------------------------------------------

--- B1: Fixed Ridge Across Sample Sizes ---
n=500:   0%|                                             | 0/10 [00:00<?, ?it/s]n=500:  10%|███▋                                 | 1/10 [00:03<00:28,  3.17s/it]n=500:  20%|███████▍                             | 2/10 [00:06<00:26,  3.34s/it]n=500:  30%|███████████                          | 3/10 [00:09<00:21,  3.09s/it]n=500:  40%|██████████████▊                      | 4/10 [00:13<00:20,  3.34s/it]n=500:  50%|██████████████████▌                  | 5/10 [00:16<00:16,  3.35s/it]n=500:  60%|██████████████████████▏              | 6/10 [00:19<00:13,  3.28s/it]n=500:  70%|█████████████████████████▉           | 7/10 [00:23<00:10,  3.37s/it]n=500:  80%|█████████████████████████████▌       | 8/10 [00:26<00:06,  3.44s/it]n=500:  90%|█████████████████████████████████▎   | 9/10 [00:30<00:03,  3.40s/it]n=500: 100%|████████████████████████████████████| 10/10 [00:33<00:00,  3.40s/it]n=500: 100%|████████████████████████████████████| 10/10 [00:33<00:00,  3.35s/it]
n=1000:   0%|                                            | 0/10 [00:00<?, ?it/s]n=1000:  10%|███▌                                | 1/10 [00:06<00:59,  6.60s/it]n=1000:  20%|███████▏                            | 2/10 [00:13<00:53,  6.70s/it]n=1000:  30%|██████████▊                         | 3/10 [00:19<00:45,  6.55s/it]n=1000:  40%|██████████████▍                     | 4/10 [00:25<00:37,  6.28s/it]n=1000:  50%|██████████████████                  | 5/10 [00:32<00:32,  6.49s/it]n=1000:  60%|█████████████████████▌              | 6/10 [00:38<00:25,  6.49s/it]n=1000:  70%|█████████████████████████▏          | 7/10 [00:46<00:20,  6.76s/it]n=1000:  80%|████████████████████████████▊       | 8/10 [00:54<00:14,  7.22s/it]n=1000:  90%|████████████████████████████████▍   | 9/10 [01:00<00:06,  6.90s/it]n=1000: 100%|███████████████████████████████████| 10/10 [01:07<00:00,  6.82s/it]n=1000: 100%|███████████████████████████████████| 10/10 [01:07<00:00,  6.73s/it]
n=2000:   0%|                                            | 0/10 [00:00<?, ?it/s]n=2000:  10%|███▌                                | 1/10 [00:14<02:07, 14.13s/it]n=2000:  20%|███████▏                            | 2/10 [00:30<02:02, 15.32s/it]n=2000:  30%|██████████▊                         | 3/10 [00:46<01:50, 15.76s/it]n=2000:  40%|██████████████▍                     | 4/10 [01:01<01:33, 15.56s/it]n=2000:  50%|██████████████████                  | 5/10 [01:15<01:14, 14.86s/it]n=2000:  60%|█████████████████████▌              | 6/10 [01:28<00:56, 14.13s/it]n=2000:  70%|█████████████████████████▏          | 7/10 [01:41<00:41, 13.95s/it]n=2000:  80%|████████████████████████████▊       | 8/10 [01:57<00:29, 14.56s/it]n=2000:  90%|████████████████████████████████▍   | 9/10 [02:11<00:14, 14.21s/it]n=2000: 100%|███████████████████████████████████| 10/10 [02:29<00:00, 15.52s/it]n=2000: 100%|███████████████████████████████████| 10/10 [02:29<00:00, 14.95s/it]
n=5000:   0%|                                            | 0/10 [00:00<?, ?it/s]n=5000:  10%|███▌                                | 1/10 [00:44<06:36, 44.09s/it]n=5000:  20%|███████▏                            | 2/10 [01:34<06:20, 47.57s/it]n=5000:  30%|██████████▊                         | 3/10 [02:11<05:01, 43.06s/it]n=5000:  40%|██████████████▍                     | 4/10 [02:57<04:23, 43.97s/it]n=5000:  50%|██████████████████                  | 5/10 [03:38<03:35, 43.19s/it]n=5000:  60%|█████████████████████▌              | 6/10 [04:21<02:51, 42.93s/it]n=5000:  70%|█████████████████████████▏          | 7/10 [05:02<02:06, 42.20s/it]n=5000:  80%|████████████████████████████▊       | 8/10 [05:43<01:24, 42.07s/it]n=5000:  90%|████████████████████████████████▍   | 9/10 [06:34<00:44, 44.83s/it]n=5000: 100%|███████████████████████████████████| 10/10 [07:15<00:00, 43.51s/it]n=5000: 100%|███████████████████████████████████| 10/10 [07:15<00:00, 43.53s/it]
n=10000:   0%|                                           | 0/10 [00:00<?, ?it/s]n=10000:  10%|███▌                               | 1/10 [01:22<12:21, 82.36s/it]n=10000:  20%|███████                            | 2/10 [02:55<11:47, 88.49s/it]n=10000:  30%|██████████▌                        | 3/10 [04:42<11:20, 97.26s/it]n=10000:  40%|██████████████                     | 4/10 [06:26<09:59, 99.96s/it]n=10000:  50%|█████████████████▌                 | 5/10 [07:53<07:55, 95.02s/it]n=10000:  60%|████████████████████▍             | 6/10 [09:45<06:43, 100.99s/it]n=10000:  70%|███████████████████████▊          | 7/10 [11:58<05:33, 111.33s/it]